CREATE TABLE TIPO_USUARIO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre VARCHAR2(255) NOT NULL 
);

CREATE TABLE USUARIO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_tipo NUMBER NOT NULL,
    nombre VARCHAR2(255) NOT NULL,
    apellido VARCHAR2(255) NOT NULL,
    correo VARCHAR2(255) NOT NULL,
    telefono VARCHAR2(255) NOT NULL,
    contraseña VARCHAR2(255) NOT NULL,
    FOREIGN KEY (id_tipo) REFERENCES tipo_usuario(id)
);

CREATE TABLE IDIOMA (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    idioma VARCHAR2(255) NOT NULL
);

CREATE TABLE PAIS (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre_pais VARCHAR2(255) NOT NULL
);

CREATE TABLE DIRECCION (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    direccion VARCHAR2(255) NOT NULL,
    estado VARCHAR2(255) NOT NULL,
    ciudad VARCHAR2(255) NOT NULL,
    codigo_postal VARCHAR2(255) NOT NULL,
    id_pais NUMBER NOT NULL,
    FOREIGN KEY (id_pais) REFERENCES PAIS(id)
);

CREATE TABLE DIRECCION_USUARIO (
    id_usuario NUMBER NOT NULL,
    id_direccion NUMBER NOT NULL,
    FOREIGN KEY (id_usuario) REFERENCES USUARIO(id),
    FOREIGN KEY (id_direccion) REFERENCES DIRECCION(id)
);

CREATE TABLE ESTADO_PRODUCTO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    estado VARCHAR2(255) NOT NULL
);

CREATE TABLE CATEGORIA_PRODUCTO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_categoria_padre NUMBER,
    nombre_categoria VARCHAR2(255) NOT NULL,
    FOREIGN KEY (id_categoria_padre) REFERENCES CATEGORIA_PRODUCTO(id)
);

CREATE TABLE PRODUCTO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_categoria NUMBER NOT NULL,
    nombre_producto VARCHAR2(255) NOT NULL,
    descripcion_producto VARCHAR2(255) NOT NULL,
    imagen_producto1 VARCHAR2(255) NOT NULL,
    imagen_producto2 VARCHAR2(255) NOT NULL,
    imagen_producto3 VARCHAR2(255) NOT NULL,
    estado NUMBER NOT NULL,
    FOREIGN KEY (id_categoria) REFERENCES categoria_producto(id),
    FOREIGN KEY (estado) REFERENCES ESTADO_PRODUCTO(id)
);

CREATE TABLE ITEM_PRODUCTO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_producto NUMBER NOT NULL,
    cantidad_disp NUMBER NOT NULL,
    precio FLOAT NOT NULL,
    estado NUMBER NOT NULL,
    FOREIGN KEY (estado) REFERENCES ESTADO_PRODUCTO(id),
    FOREIGN KEY (id_producto) REFERENCES PRODUCTO(id)
);

CREATE TABLE VARIACION (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre VARCHAR2(255) NOT NULL
);

CREATE TABLE OPCION_VARIACION (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_variacion NUMBER NOT NULL,
    valor VARCHAR(255) NOT NULL,
    FOREIGN KEY (id_variacion) REFERENCES VARIACION(id)
);

CREATE TABLE CONFIGURACION_PRODUCTO (
    id_item_producto NUMBER NOT NULL,
    id_opcion_variacion NUMBER NOT NULL,
    FOREIGN KEY (id_item_producto) REFERENCES ITEM_PRODUCTO(id),
    FOREIGN KEY (id_opcion_variacion) REFERENCES OPCION_VARIACION(id)
);

CREATE TABLE METODO_PAGO_USUARIO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_usuario NUMBER NOT NULL,
    numero_tarjeta VARCHAR(255) NOT NULL,
    cvv VARCHAR(255) NOT NULL,
    nombre_portador VARCHAR(255) NOT NULL,
    fecha_expiracion VARCHAR(255) NOT NULL,
    FOREIGN KEY (id_usuario) REFERENCES USUARIO(id)
);

CREATE TABLE CARRITO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_usuario NUMBER NOT NULL,
    FOREIGN KEY (id_usuario) REFERENCES USUARIO(id)
);

CREATE TABLE CARRITO_ITEM (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_carrito NUMBER NOT NULL,
    id_item_producto NUMBER NOT NULL,
    cantidad NUMBER NOT NULL,
    FOREIGN KEY (id_carrito) REFERENCES CARRITO(id),
    FOREIGN KEY (id_item_producto) REFERENCES ITEM_PRODUCTO(id)
);

CREATE TABLE METODO_ENVIO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre VARCHAR(255) NOT NULL,
    precio FLOAT NOT NULL
);

CREATE TABLE ESTADO_ORDEN (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    estado VARCHAR(255) NOT NULL
);

CREATE TABLE ORDEN (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_usuario NUMBER NOT NULL,
    fecha_hora TIMESTAMP NOT NULL,
    id_metodo_pago NUMBER NOT NULL,
    direccion_envio NUMBER NOT NULL,
    metodo_envio NUMBER NOT NULL,
    total_orden FLOAT NOT NULL,
    estado_orden NUMBER NOT NULL,
    FOREIGN KEY (id_usuario) REFERENCES USUARIO(id),
    FOREIGN KEY (id_metodo_pago) REFERENCES METODO_PAGO_USUARIO(id),
    FOREIGN KEY (direccion_envio) REFERENCES DIRECCION(id),
    FOREIGN KEY (metodo_envio) REFERENCES METODO_ENVIO(id),
    FOREIGN KEY (estado_orden) REFERENCES ESTADO_ORDEN(id)
);

CREATE TABLE ORDEN_ITEM (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_item_producto NUMBER NOT NULL,
    id_orden NUMBER NOT NULL,
    cantidad NUMBER NOT NULL,
    precio FLOAT NOT NULL,
    FOREIGN KEY (id_orden) REFERENCES ORDEN(id),
    FOREIGN KEY (id_item_producto) REFERENCES ITEM_PRODUCTO(id)
);

CREATE TABLE PROMOCION (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre VARCHAR(255) NOT NULL,
    descripcion VARCHAR(255) NOT NULL,
    descuento_porcentaje FLOAT NOT NULL,
    fecha_inicio DATE NOT NULL,
    fecha_final DATE NOT NULL
);

CREATE TABLE PROMOCION_CATEGORIA (
    id_categoria NUMBER NOT NULL,
    id_promocion NUMBER NOT NULL,
    FOREIGN KEY (id_categoria) REFERENCES CATEGORIA_PRODUCTO(id),
    FOREIGN KEY (id_promocion) REFERENCES PROMOCION(id)
);



-- MANEJO DE BANCO Y TARJETAS
CREATE TABLE BANCO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    id_cuenta_dueño NUMBER(20) NOT NULL,
    nombre_dueño VARCHAR2(255) NOT NULL,
    saldo DECIMAL(10, 2) NOT NULL
);

CREATE TABLE TARJETA (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    nombre_tarjeta VARCHAR2(255) NOT NULL,
    numero_tarjeta VARCHAR2(16) NOT NULL,
    cvv VARCHAR2(3) NOT NULL,
    fecha_vencimiento VARCHAR2(7) NOT NULL, -- Formato 'MM/YYYY'
    id_banco NUMBER NOT NULL,
    FOREIGN KEY (id_banco) REFERENCES BANCO(id) -- Referencia la clave primaria de BANCO
);


